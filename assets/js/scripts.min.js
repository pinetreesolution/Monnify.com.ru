( function ( $, window, document ) {
  $( document ).ready( function () {
    //AOS Initialization
    $( function () {
      AOS.init( {
        once: true,
        mirror: false
      } );
    } );
  } );

  $( document ).ready( function () {
    //Header Mobile Mneu
    $( ".menu-trigger a, .sidenav .close" ).click( function () {
      $( ".page .sidenav" ).toggleClass( "show" );
    } );

    $( ".quote-slide" ).owlCarousel( {
      loop: false,
      center: false,
      margin: 25,
      autoWidth: true,
      items: 5
    } );
  } );

  //mouse icon click scroll
  $( document ).ready( function () {
    $( ".scroll_" ).click( function () {
      $( "html, body" ).animate(
        {
          scrollTop: $( "#feat" ).offset().top
        },
        1000
      );
    } );
  } );

  //Testimonial slides
  $( document ).ready( function () {
    var _index = 1;
    $( ".testimonials .quote-slide .card" ).click( function ( e ) {
      e.preventDefault();
      _index = $( this ).parent().index() + 1;
      $( ".testimonials .quote-slide .card" ).removeClass( "active" );
      $( this ).addClass( "active" );

      $( ".testimonials .wrapr" ).removeClass( "active" );
      $( ".testimonials .wrapr.t_" + _index ).addClass( "active" );

      $( ".testimonials .image" ).removeClass( "active" );
      $( ".testimonials .image.img_" + _index ).addClass( "active" );
    } )

    //autoplay script 

    setInterval( function () {
      _index++;
      if ( _index > 5 )
      {
        _index = 1;
      }

      $( ".testimonials .quote-slide .owl-item:nth-child(" + _index + ")" ).find( ".card" ).trigger( "click" );
    }, 5000 );
  } );

  //FAQ List Focus
  $( document ).ready( function () {
    $( ".faqs .wrap" ).click( function () {
      $( this )
        .attr( "tabindex", -1 )
        .focus();

      $( ".plus", this ).toggleClass( "hide" );
      $( ".minus", this ).toggleClass( "show" );
    } );
  } );

  //Pricing calculator
  $( document ).ready( function () {
    var $input = $( "#pricingFormat" );
    var $form = $( "#pricing" );
    var config = {
      rate: 1.5,
      cap: 2000,
      input: 10000
    };

    $( ".select-tab a" ).click( function ( e ) {
      e.preventDefault();
      $( ".select-tab a" ).removeClass( "active" );
      $( this ).addClass( "active" );
      
      displayPricing();

    } )

    function currencyFormat( num ) {
      return "â‚¦" + num.toFixed( 2 ).replace( /(\d)(?=(\d{3})+(?!\d))/g, "$1," );
    }

    function displayPricing() {
      var price = config.input * ( config.rate / 100 );
      var vat = price * 0.075;

      if ( price >= config.cap )
      {
        vat = config.cap * 0.075
        $( ".naration .row .col-lg-7 .cap span" ).text( config.cap );
        $( ".naration .row .col-lg-7 .cap" ).addClass( "active" );
        price = config.input - (config.cap + vat);
      }
      else
      {
        $( ".naration .row .col-lg-7 .cap" ).removeClass( "active" );
        price = config.input - (price + vat);
      }
      $( ".naration .row .col-lg-7 h1" ).html( currencyFormat( price ) );
      $( ".naration .row .col-lg-5 h1" ).text( config.rate + "%" );
    }

    $( ".calculate" ).click( function () {
      displayPricing();
    } );

    $input.on( "keyup", function ( event ) {
      if ( $.inArray( event.keyCode, [38, 40, 37, 39] ) !== -1 )
      {
        return;
      }
      var $this = $( this );
      var input = $this.val().replace( /[\D\s\._\-]+/g, "" );
      input = input ? parseInt( input, 10 ) : 0;
      config.input = parseInt( input, 10 );

      displayPricing();

      $this.val( function () {
        return input === 0 ? "" : input.toLocaleString();
      } );
    } );

    $form.submit( function ( e ) {
      e.preventDefault();
    } );
  } );

  //signup form post
  $( document ).ready( function () {
    $( ".signup-form" ).submit( function ( e ) {
      e.stopPropagation();
      e.preventDefault();

      var _submitBtn = $( this ).find( "button" );
      _submitBtn.text( "Please wait..." );
      var payload = {
        businessName: $( this ).find( "[name=name]" ).val(),
        email: $( this ).find( "[name=email]" ).val(),
        password: $( this ).find( "[name=password]" ).val()
      }
      var _url = "https://sandbox.fo.monnify.com/";
      if ( location.href.match( /.*(localhost)/g ) )
      {
        console.log( "We are not LIVE" )
        _url = "https://sandbox.fo.monnify.com/";
      }
      else
      {
        console.log( "We are LIVE" )
        _url = "https://fo.monnify.com/api/v1/onboarding/signup";
      };

      $.ajax(
        {
          url: _url,
          type: "POST",
          data: JSON.stringify( payload ),
          dataType: "json",
          contentType: "application/json; charset=utf-8",
          success: function ( result ) {
            if ( result && result.requestSuccessful == true )
            {
              $( ".apt-modal .item" ).removeClass( "active" );
              $( ".apt-modal" ).addClass( "active" );
              $( ".apt-modal .item.success" ).delay( 500 ).addClass( "active" );
              _submitBtn.text( "Sign up" );
            }
            else
            {
              $( ".apt-modal .item" ).removeClass( "active" );
              $( ".apt-modal" ).addClass( "active" );
              $( ".apt-modal .item.error" ).delay( 500 ).addClass( "active" );
              _submitBtn.text( "Sign up" );
            }
          },
          error: function ( e ) {
            $( ".apt-modal .item" ).removeClass( "active" );
            $( ".apt-modal" ).addClass( "active" );
            $( ".apt-modal .item.error" ).delay( 500 ).addClass( "active" );
            _submitBtn.text( "Sign up" );
          }
        } );
    } )

    $( ".signup-form input[type=password]" ).focus( function ( e ) {
      $( ".signup-form .pass-strength" ).addClass( "active" );
    } )
    $( ".signup-form input[type=password]" ).blur( function ( e ) {
      $( ".signup-form .pass-strength" ).removeClass( "active" );
    } )


    $( ".apt-modal .modal-close" ).click( function ( e ) {
      e.preventDefault();
      e.stopPropagation();
      $( ".apt-modal" ).removeClass( "active" );
    } )
  } )

} )( jQuery, window, document );
